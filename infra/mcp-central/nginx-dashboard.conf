events {
    worker_connections 1024;
}

http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;
    
    # Main dashboard (port 80 -> 3010)
    server {
        listen 80;
        
        location / {
            root /usr/share/nginx/html;
            index index.html;
        }
        
        location /api/health {
            access_log off;
            return 200 '{"status":"healthy","version":"1.0","timestamp":"$time_iso8601","servers":1}';
            add_header Content-Type application/json;
        }
        
        location /api/servers {
            access_log off;
            return 200 '{"servers":[{"name":"fetch-mcp","status":"running","governance_level":"low","tools":["fetch","http_request"]}],"count":1}';
            add_header Content-Type application/json;
        }
    }
    
    # A2A Protocol endpoint (port 81 -> 3011)
    server {
        listen 81;
        
        location /health {
            access_log off;
            return 200 '{"protocol":"A2A","status":"active","version":"1.0"}';
            add_header Content-Type application/json;
        }
        
        location /agent-card {
            access_log off;
            return 200 '{"agent":"mcp-central","capabilities":["fetch","github","memory"],"version":"1.0"}';
            add_header Content-Type application/json;
        }
    }
    
    # Docker Bridge endpoint (port 82 -> 3012)
    server {
        listen 82;
        
        location /health {
            access_log off;
            return 200 '{"bridge":"docker-mcp","status":"operational","containers":1}';
            add_header Content-Type application/json;
        }
        
        location /containers {
            access_log off;
            return 200 '{"containers":["fetch-mcp"],"registry":"localhost:5000","status":"connected"}';
            add_header Content-Type application/json;
        }
    }
}